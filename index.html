<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Suelo Vital SN</title>
<style>
  body {
    font-family: "Inter", sans-serif;
    background: linear-gradient(to bottom, #a8e063, #56ab2f);
    color: #333;
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 0;
    padding: 20px;
  }

  h1 {
    color: #fff;
    text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
    font-size: 2rem;
    margin-bottom: 5px;
  }

  h2 {
    color: #f7f7f7;
    font-weight: 400;
    margin-top: 0;
  }

  table {
    width: 95%;
    max-width: 900px;
    background: #fff;
    border-radius: 15px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.2);
    overflow: hidden;
    border-collapse: collapse;
    margin-top: 10px;
  }

  th, td {
    text-align: center;
    padding: 14px;
  }

  th {
    background: #f4f4f4;
    color: #333;
    font-weight: bold;
  }

  tr:nth-child(even) {
    background: #f9f9f9;
  }

  #estado {
    font-weight: bold;
    color: white;
    border-radius: 20px;
    padding: 10px 20px;
    display: inline-block;
  }

  .rojo {
    background-color: #e74c3c;
  }

  .amarillo {
    background-color: #f1c40f;
    color: #000;
  }

  .verde {
    background-color: #2ecc71;
  }

  footer {
    margin-top: 25px;
    font-size: 0.9rem;
    color: #fff;
    text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
  }

  .leyenda {
    display: flex;
    gap: 15px;
    margin-bottom: 10px;
    color: #fff;
    align-items: center;
    justify-content: center;
  }

  .cuadro {
    width: 15px;
    height: 15px;
    border-radius: 3px;
    display: inline-block;
    margin-right: 5px;
  }

  .verde-bg { background: #2ecc71; }
  .amarillo-bg { background: #f1c40f; }
  .rojo-bg { background: #e74c3c; }

  .canal {
    margin-top: 5px;
    font-size: 0.9rem;
    color: #fff;
  }

  .actualizacion {
    color: #fff;
    margin-top: 10px;
    font-size: 0.9rem;
  }

</style>
</head>
<body>

<h1>ðŸŒ¿ Suelo Vital SN</h1>
<h2>Tu jardÃ­n siempre perfecto, sin que te des cuenta</h2>

<div class="leyenda">
  <span><span class="cuadro verde-bg"></span> Correcto (> 22 cm)</span>
  <span><span class="cuadro amarillo-bg"></span> Intermedio (20â€“22 cm)</span>
  <span><span class="cuadro rojo-bg"></span> Error (< 20 cm)</span>
</div>

<table>
  <thead>
    <tr>
      <th>Nombre del Cliente</th>
      <th>DirecciÃ³n</th>
      <th>Altura S1</th>
      <th>Altura S2</th>
      <th>Altura S3</th>
      <th>Altura S4</th>
      <th>Altura Promedio</th>
      <th>Estado</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>ITEC</td>
      <td>Av. Pres. Juan Domingo PerÃ³n 1933</td>
      <td id="s1">--</td>
      <td id="s2">--</td>
      <td id="s3">--</td>
      <td id="s4">--</td>
      <td id="promedio">--</td>
      <td><span id="estado">--</span></td>
    </tr>
  </tbody>
</table>

<p class="canal">Canal: 3141855</p>
<p class="actualizacion" id="actualizacion">Ãšltima actualizaciÃ³n: --</p>

<footer>Â© 2025 Suelo Vital SN â€” Proyecto ITEC</footer>

<script>
  const channelID = 3141855;
  const readAPIKey = "LMNEZ5PKF2Q9HUAH";

  async function obtenerDatos() {
    try {
      const url = `https://api.thingspeak.com/channels/${channelID}/feeds.json?api_key=${readAPIKey}&results=1`;
      const respuesta = await fetch(url);
      const datos = await respuesta.json();
      const feed = datos.feeds[0];

      const s1 = parseFloat(feed.field1);
      const s2 = parseFloat(feed.field2);
      const s3 = parseFloat(feed.field3);
      const s4 = parseFloat(feed.field4);
      const promedio = parseFloat(feed.field5);

      document.getElementById("s1").textContent = s1.toFixed(2);
      document.getElementById("s2").textContent = s2.toFixed(2);
      document.getElementById("s3").textContent = s3.toFixed(2);
      document.getElementById("s4").textContent = s4.toFixed(2);
      document.getElementById("promedio").textContent = promedio.toFixed(2);

      const estado = document.getElementById("estado");
      estado.className = "";

      if (promedio < 20) {
        estado.textContent = "ERROR (menos de 20 cm)";
        estado.classList.add("rojo");
      } else if (promedio >= 20 && promedio <= 22) {
        estado.textContent = "INTERMEDIO (20â€“22 cm)";
        estado.classList.add("amarillo");
      } else {
        estado.textContent = "CORRECTO (> 22 cm)";
        estado.classList.add("verde");
      }

      const fecha = new Date(feed.created_at);
      document.getElementById("actualizacion").textContent =
        "Ãšltima actualizaciÃ³n: " + fecha.toLocaleString();
    } catch (e) {
      console.error("Error al obtener datos:", e);
    }
  }

  obtenerDatos();
  setInterval(obtenerDatos, 20000);
</script>

</body>
</html>
